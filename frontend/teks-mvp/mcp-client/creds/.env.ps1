$env:AWS_ACCESS_KEY_ID="REPLACE_ME"
$env:AWS_SECRET_ACCESS_KEY="REPLACE_ME"
$env:AWS_REGION="eu-north-1"
$env:BEDROCK_MODEL_ID="amazon.nova-lite-v1:0"
$env:AWS_BEARER_TOKEN_BEDROCK = "bedrock-api-key-YmVkcm9jay5hbWF6b25hd3MuY29tLz9BY3Rpb249Q2FsbFdpdGhCZWFyZXJUb2tlbiZYLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFTSUFVUjZYM1FDUFpONUZDR1JVJTJGMjAyNTEwMjIlMkZldS1ub3J0aC0xJTJGYmVkcm9jayUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUxMDIyVDE1MDQwMFomWC1BbXotRXhwaXJlcz00MzIwMCZYLUFtei1TZWN1cml0eS1Ub2tlbj1JUW9KYjNKcFoybHVYMlZqRUhjYUNtVjFMVzV2Y25Sb0xURWlTREJHQWlFQTB6YnBjaU9XVFpHbXZhMExDTkEwRVpmcmZhMkQlMkJqNXM4dXVWNlNLQjhzTUNJUUNES2d5RHN4ciUyRjIxVWRRYkVBJTJGNDJzMlZRUXdpNW40UWJOcWZkcThZdmx0Q3FsQXdnd0VBQWFERE14TXpRME9EUXpNVGMzTlNJTVR2ME5IcUElMkZMRjclMkZkMVYwS29JRGtJMU9oWmp5T0VaTFJyNXlRYmEyMjVNVEpzYmxyUFdFYW9PJTJGc3lLQnFhJTJCa2dXWEFrOGlVWEp4aWRETDNvSER2c01BSElGSFhpSzZpQURrZUQzTm9KOW1Zck1uNmd4SUJiYnR0c2NLZTNhWHcwVWZ0Zk96Tmc3UWVicmtSbSUyQlFXaDRmVVVRTTZESW5SZE1xdDU0WXpla0l4ajhabFJjUnlhdDF4clNQRUxBZjd2bHhMVGtyJTJCaE5hQzhaSjB6eEtDWGFINTZUb21UR1ZXSmdDSHlNMlhZdTVUR3VUMHhFNjBxSzZ6bEJxRGhmaTkyJTJGSDBpckF3TDAlMkJZYWJ0MjFyQWJ4azN5RXFjekRGMnZFUTZ0S1VkcDZXNEFlOFc5MVozbER4UDZqa1JVSyUyQk1jZEltd1JRV0JmZHRlbmpoeUdlVG4xdGNlMDdhWFNSZXF0aTQwTnNlNHVDc0VHYWd2eXcyS0o2bDgyZTdnRGJPWFNSN0JGR0FqUEFoVVdCY0N5JTJGYTN3cDRmbDNtcWJudjBpbG11VW50emZFZXFvclI1blY0ZVZwSXU1N2tUbUgydWVWMjhVTVZTak9oZCUyQkFLQjdaY3N4MmlEMTRGM0dPcFlXRERZdENaYzBRalBpNk1GcW03d3JSS1VIb2lWMWo5JTJCYTlvWGRISlhaejRzdEprRTRFSUxWRlF3eCUyQlRqeHdZNjNRSXFGOVFwRUdOcHlFSjd2OVl2Mk9nNFBTRGQyU3VSYU9qN2pFTGJOWHhldmdzaE43UnVGaHRMN1g2QnhhQjlhZVhkRTNxUGZJNFFrJTJGeGsxZ042aWolMkZ4Mk0lMkYyUlBFZEdOeXhZdkFuOXNEWjlXVSUyRjE5MGJ2QnNzYVZTeFBwU1BIRnp6dDZXVjJjUkNrT1lMUUhIUFlXS29ibGNqSTBaSXRYWDZtTWQ4MjJuZlczeGhDRUdhczV3ck56UmlMZWN5YUs4TzJBRCUyQldIRHdRaUMxM0xMMFQ0VjUxZFBTRXQ2SSUyQmZBc1d5dzA5eGF6dE9IdHpUeFNTY3V2eWtadyUyRll3dWNVZm5abk1WSElIb1Vuc0FEOHFHVHNxbzJmOXk4UFolMkZwTlpqcmFLZkVzcSUyQnhRdHNCc2ZIckNDcERiamgxdG9VUnB1TDZrWHo5WEUwJTJGNEVValp6OXolMkJWb0VqTm9QRkpqSmx6WEFYSHBtQkM4NFBsdUprY0d5Z3dZZzJwUzNwbFlEeEM3WjdMZ1M5JTJCVUxkNEs3OWVpNE5jMGpjcUd2a3Z2bzdLMGlrTzVjZkEwSUJJN3lJZ05TeEp6NmtsaXVVbk5WUHYxekx4UGZIcDRqJTJGR3hsM1RPJlgtQW16LVNpZ25hdHVyZT1lY2E2MDRkMTQ2MzgxYjA2MWU3MWY1YzRjMzIwOTg4MmIyOGM5MDgzNWIxNWRhMDlhZDhiNTg0MzQzMmNiMDI2JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZWZXJzaW9uPTE="
$env:TEST_API_BASE = "https://localhost:7140"
$env:TEST_USERNAME = "admin"
$env:TEST_PASSWORD = "ChangeMe123!"

# Build request
$uri = "https://bedrock-runtime.$($env:AWS_REGION).amazonaws.com/openai/v1/chat/completions"

$body = @{
  model = $env:BEDROCK_MODEL_ID
  messages = @(
    @{ role = "user"; content = "Hello from PowerShell! Say hi and give 2 short tips." }
  )
  max_tokens = 200
} | ConvertTo-Json -Depth 10

# Send request
$response = Invoke-RestMethod -Uri $uri -Method Post -Headers @{
  "Authorization" = "Bearer $($env:AWS_BEARER_TOKEN_BEDROCK)"
  "Content-Type"  = "application/json"
} -Body $body

# Print result
$response.choices[0].message.content