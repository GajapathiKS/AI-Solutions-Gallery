$env:AWS_ACCESS_KEY_ID="REPLACE_ME"
$env:AWS_SECRET_ACCESS_KEY="REPLACE_ME"
$env:AWS_REGION="eu-north-1"
$env:BEDROCK_MODEL_ID="amazon.nova-lite-v1:0"
$env:AWS_BEARER_TOKEN_BEDROCK = "bedrock-api-key-YmVkcm9jay5hbWF6b25hd3MuY29tLz9BY3Rpb249Q2FsbFdpdGhCZWFyZXJUb2tlbiZYLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFTSUFVUjZYM1FDUDczS0czVUwyJTJGMjAyNTEwMjElMkZldS1ub3J0aC0xJTJGYmVkcm9jayUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUxMDIxVDAyMzMyM1omWC1BbXotRXhwaXJlcz00MzIwMCZYLUFtei1TZWN1cml0eS1Ub2tlbj1JUW9KYjNKcFoybHVYMlZqRUZJYUNtVjFMVzV2Y25Sb0xURWlSekJGQWlFQXpYcE4ya2gyd0ZiMHRHQ0N3cUtKcGVrSXpxRmFtbFRxcDc4VnhyUDIlMkI3b0NJRUozdTN5V3J6djV5VUhhbUFrelgyanJMOFAxNnpsbkVxemRacncyVEMxdEtxNERDUHolMkYlMkYlMkYlMkYlMkYlMkYlMkYlMkYlMkYlMkZ3RVFBQm9NTXpFek5EUTRORE14TnpjMUlneFRMMFRrelZVSGpWellmY2NxZ2dNVzdJSXhDOXc1bHppVVM0emJLOGdsR2tiODhLckRRTUszR3NxJTJGN1F6b3lwZWU1a0dHVmxDS05zcFZ3bHRZUDdOa25lT2tkODRzbTdRJTJGUkVUMWlnSkl6cEJLdVl1d0hueGxNSUV0bm92TGVYM1RNUDFNNlglMkY1eFUwaEpJV3lwQ0pRc25QTmtVM25JZ3FJTjBpZVFzQVpleSUyRmxESmZXWmZlNk5WcHU2d21YMzVDYmVGUlZtbXhKQVAycUZxM2JRemNJNkxyJTJGJTJCVFM3bUlkY1N4THU0UThWazRMdkxIcVo3dVdMWlN4WGlnU2JRUHFrWFozQ2RRSVdjcVQ5OVQ4UlFRbU5UM1pxWXZhMGVIQXg1SXpIT1NQJTJCUDgxNWZuRHY5VHRTb0w5UjI2M1p1WnltOE1yQWtBWnpqcGRuTmpsc3d3ZUVqTnZCMjNKR2pyWmg2SzElMkZjU2V3eCUyRktBSlNVV1BMSzNXVVlaRSUyQnhjak5hQklkcFVWYW9TYTZHTjBmS3pFekk1RnQlMkJxcCUyRjV4Q0NtbjY5JTJGU1RnUSUyRjNaaFZGb3VOc2VhT0tlM29EMUNGc2tZTG4xd0pibHg2OHVTRldmM1hCZzd4dnNnd3YwVHZZYVBPMTh1Sk1NcUl4QVJLWGRxaldycGtycU1ubjZ2TFluZWVZQ2hJcGlIYnlxaThFOSUyQlpteXBUb3pDVTI5dkhCanJlQWllRlhKWnAyWmJEY3RUckdTSW8wJTJCNG5mSG5WUG1IMk41NjklMkZneVl0UUJQY3JxVXd4N2FKRWVGTGMlMkZUak1lY3BsJTJCdk1rSnl4SHZKbDJSOFk5MXNkVVJxUmNFJTJGNzRQWHBkQzVPbEgyNFA0a0JnNGlQJTJCTzJzM3piRGlCM0k1RjBScEtyJTJGOFVYbUgxSFh2elBRVSUyRk92UkElMkZiNW1INWFkS1RvOEFwRXJnSExuTmtTY3QwcEhkMVg0bjJnWG9qdXAwcVlhbmpBMURCSEdwcFVOY2lYaGhmaVglMkZBQlFtQ2xtQ3VIdlN5RjhxTXY3JTJGTjlEdDZ1a0Y2c01tTWtYdUNGQUg3dmRDenkwd21URGE1b1glMkZycW00Q0ZYV00lMkI2MVY0Y01BJTJCM01DcHVyRGNyQ2ElMkJRN3pUT0ZQSnY2T20zMmtRdlN5RXZ4TUxMblQ2QnNQdW5nQ2Ezb1F5RHJFUmlkM0FxbktDMWclMkJhRHZhODlqWHpPb0Y5REhkV2ZZRWIwcDBObGgwTXdHUkwlMkZwM1Y1cjM0TWFNMzdlUVI2RUJ6QjRQdG9EaWxHUVZmOVVTam5jbDRabkZhVDl4dUp6VXo2R3EyJTJCa2dpTnhvJTJGckYzN3E3d1ZlNEdTSlImWC1BbXotU2lnbmF0dXJlPWY1MmJmZWI5NjI3N2NkODUwYmEzN2UxNGI5ODRlOTZmMzZjMDM1MTljYTMzOWVkNDEzNDFlYjVlYjk2YWU4MDImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JlZlcnNpb249MQ=="
$env:TEST_API_BASE = "https://localhost:7140"
$env:TEST_USERNAME = "admin"
$env:TEST_PASSWORD = "ChangeMe123!"

# Build request
$uri = "https://bedrock-runtime.$($env:AWS_REGION).amazonaws.com/openai/v1/chat/completions"

$body = @{
  model = $env:BEDROCK_MODEL_ID
  messages = @(
    @{ role = "user"; content = "Hello from PowerShell! Say hi and give 2 short tips." }
  )
  max_tokens = 200
} | ConvertTo-Json -Depth 10

# Send request
$response = Invoke-RestMethod -Uri $uri -Method Post -Headers @{
  "Authorization" = "Bearer $($env:AWS_BEARER_TOKEN_BEDROCK)"
  "Content-Type"  = "application/json"
} -Body $body

# Print result
$response.choices[0].message.content